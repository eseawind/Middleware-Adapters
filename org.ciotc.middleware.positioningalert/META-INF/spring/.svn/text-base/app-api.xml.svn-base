<beans xmlns="http://www.springframework.org/schema/beans"
	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xmlns:osgi="http://www.springframework.org/schema/osgi"
	xsi:schemaLocation="http://www.springframework.org/schema/beans
    http://www.springframework.org/schema/beans/spring-beans-3.0.xsd
    http://www.springframework.org/schema/osgi
    http://www.springframework.org/schema/osgi/spring-osgi.xsd">

	<bean id="appManager" class="org.ciotc.middleware.api.service.appmanager.AppManagerImpl">
		<property name="ciotcApps" ref="ciotcApps" />
		<property name="esperService" ref="esperManager" />
	</bean>

	<bean id="AppManagerCommands"
		class="org.ciotc.middleware.api.service.appmanager.AppManagerCommandProvider">
		<property name="appManager" ref="appManager" />
	</bean>

	<bean id="SensorStatusAppService"
		class="org.ciotc.middleware.api.service.sensormonitor.SensorStatusMonitoringServiceImpl">
		<constructor-arg index="0" value="AppService" />
		<constructor-arg index="1" value="SensorStatus" />
	</bean>

	<bean id="TagIntegrationAppService"
		class="org.ciotc.middleware.api.service.tagmonitor.TagIntegrationServiceImpl">
		<constructor-arg index="0" value="AppService" />
		<constructor-arg index="1" value="TagIntegration" />
	</bean>

	<bean id="FlowrateIntegrationAppService"
		class="org.ciotc.middleware.api.service.tagmonitor.FlowrateIntegrationServiceImpl">
		<constructor-arg index="0" value="AppService" />
		<constructor-arg index="1" value="FlowrateIntegration" />
	</bean>

	<bean id="StaffDataFilterAppService"
		class="org.ciotc.middleware.api.service.staffposmonitor.StaffDataFilterServiceImpl">
		<constructor-arg index="0" value="AppService" />
		<constructor-arg index="1" value="StaffDataFilter" />
	</bean>

	<bean id="IssuingCardFilterAppService"
		class="org.ciotc.middleware.api.service.staffposmonitor.IssuingCardFilterServiceImpl">
		<constructor-arg index="0" value="AppService" />
		<constructor-arg index="1" value="IssuingCardFilter" />
	</bean>

	<osgi:set id="ciotcApps" interface="org.ciotc.middleware.api.CiotcApp" cardinality="0..N">
		<osgi:listener ref="appManager" bind-method="bindApp" unbind-method="unbindApp" />
	</osgi:set>


	<osgi:service ref="AppManagerCommands" interface="org.eclipse.osgi.framework.console.CommandProvider" />
	<osgi:service ref="SensorStatusAppService" auto-export="interfaces" />
	<osgi:service ref="TagIntegrationAppService" auto-export="interfaces" />
	<osgi:service ref="FlowrateIntegrationAppService" auto-export="interfaces" />
	<osgi:service ref="StaffDataFilterAppService" auto-export="interfaces" />
	<osgi:service ref="IssuingCardFilterAppService" auto-export="interfaces" />

</beans>